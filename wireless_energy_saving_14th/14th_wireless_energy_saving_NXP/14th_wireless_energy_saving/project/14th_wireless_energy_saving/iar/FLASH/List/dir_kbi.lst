###############################################################################
#
# IAR ANSI C/C++ Compiler V7.70.1.11437/W32 for ARM       08/Jul/2019  02:42:57
# Copyright 1999-2016 IAR Systems AB.
#
#    Cpu mode     =  thumb
#    Endian       =  little
#    Source file  =  
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\app\device\src\dir_kbi.c
#    Command line =  
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\app\device\src\dir_kbi.c
#        -D LPLD_K60 -lCN
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\FLASH\List
#        -lB
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\FLASH\List
#        -o
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\FLASH\Obj
#        --no_cse --no_unroll --no_inline --no_code_motion --no_tbaa
#        --no_clustering --no_scheduling --debug --endian=little
#        --cpu=Cortex-M4 -e --fpu=None --dlib_config "D:\Program Files
#        (x86)\IAR Systems\Embedded Workbench
#        7.5\arm\INC\c\DLib_Config_Normal.h" -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\CPU\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\common\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\LPLD\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\LPLD\HW\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\LPLD\DEV\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\uCOS-II\Ports\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\uCOS-II\Source\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\FatFs\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\FatFs\option\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\USB\common\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\USB\driver\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\USB\descriptor\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\USB\class\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\control\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\debug\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\device\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\signal\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\system\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\control\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\debug\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\device\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\signal\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\system\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\drivers\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\drivers\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\charge\inc\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\app\charge\src\
#        -I
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\..\..\..\lib\LPLD\FUNC\
#        -Ol -I "D:\Program Files (x86)\IAR Systems\Embedded Workbench
#        7.5\arm\CMSIS\Include\" -D ARM_MATH_CM4
#    Locale       =  Chinese (Simplified)_China.936
#    List file    =  
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\FLASH\List\dir_kbi.lst
#    Object file  =  
#        D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\iar\FLASH\Obj\dir_kbi.o
#
###############################################################################

D:\Freescale\无线节能14th\wireless_energy_saving_14th\14th_wireless_energy_saving_NXP\14th_wireless_energy_saving\project\14th_wireless_energy_saving\app\device\src\dir_kbi.c
      1          /*=============================================
      2              @file         dir_kbi.c
      3              @brief        五向按键
      4              @programmer   Beyond Hsueh
      5          =============================================*/
      6                
      7          #include "dir_kbi.h"
      8          
      9          /*===============================================================
     10                  @note      谁念西风独自凉？萧萧黄叶闭疏窗。沉思往事立残阳。
     11                             被酒莫惊春睡重，赌书消得泼茶香。当时只道是寻常。
     12          ==================================================================*/      
     13          
     14          /*===============================================================
     15          	@brief     五向按键引脚初始化
     16          ==================================================================*/

   \                                 In section .text, align 2, keep-with-next
     17          void Five_Dir_Init()
     18          {
   \                     Five_Dir_Init: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     19              GPIO_Init(FIVE_DIR_O_PORT, FIVE_DIR_O_PIN_MASK, DIR_INPUT, OUTPUT_L);
   \   00000002   0x2300             MOVS     R3,#+0
   \   00000004   0x2200             MOVS     R2,#+0
   \   00000006   0x2101             MOVS     R1,#+1
   \   00000008   0x....             LDR.N    R0,??DataTable2  ;; 0x400ff0c0
   \   0000000A   0x.... 0x....      BL       GPIO_Init
     20              GPIO_Init(FIVE_DIR_U_PORT, FIVE_DIR_U_PIN_MASK, DIR_INPUT, OUTPUT_L);
   \   0000000E   0x2300             MOVS     R3,#+0
   \   00000010   0x2200             MOVS     R2,#+0
   \   00000012   0x2102             MOVS     R1,#+2
   \   00000014   0x....             LDR.N    R0,??DataTable2  ;; 0x400ff0c0
   \   00000016   0x.... 0x....      BL       GPIO_Init
     21              GPIO_Init(FIVE_DIR_D_PORT, FIVE_DIR_D_PIN_MASK, DIR_INPUT, OUTPUT_L); 
   \   0000001A   0x2300             MOVS     R3,#+0
   \   0000001C   0x2200             MOVS     R2,#+0
   \   0000001E   0xF45F 0x2100      MOVS     R1,#+524288
   \   00000022   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000024   0x.... 0x....      BL       GPIO_Init
     22              GPIO_Init(FIVE_DIR_L_PORT, FIVE_DIR_L_PIN_MASK, DIR_INPUT, OUTPUT_L);
   \   00000028   0x2300             MOVS     R3,#+0
   \   0000002A   0x2200             MOVS     R2,#+0
   \   0000002C   0xF45F 0x2180      MOVS     R1,#+262144
   \   00000030   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000032   0x.... 0x....      BL       GPIO_Init
     23              GPIO_Init(FIVE_DIR_R_PORT, FIVE_DIR_R_PIN_MASK, DIR_INPUT, OUTPUT_L);     
   \   00000036   0x2300             MOVS     R3,#+0
   \   00000038   0x2200             MOVS     R2,#+0
   \   0000003A   0xF44F 0x5100      MOV      R1,#+8192
   \   0000003E   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000040   0x.... 0x....      BL       GPIO_Init
     24          }
   \   00000044   0xBD01             POP      {R0,PC}          ;; return
     25          
     26          /*===============================================================
     27          	@brief     获取五向按键引脚状态
     28          ==================================================================*/

   \                                 In section .text, align 2, keep-with-next
     29          uint8 Get_Five_Dir_Value(uint8 *switchData)
     30          {
   \                     Get_Five_Dir_Value: (+1)
   \   00000000   0xB580             PUSH     {R7,LR}
     31              if(!LPLD_GPIO_Input_b(FIVE_DIR_R_PORT, FIVE_DIR_R_PIN))
   \   00000002   0x210D             MOVS     R1,#+13
   \   00000004   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000006   0x.... 0x....      BL       LPLD_GPIO_Input_b
   \   0000000A   0x2800             CMP      R0,#+0
   \   0000000C   0xD101             BNE.N    ??Get_Five_Dir_Value_0
     32                return FIVE_DIR_RIGHT;
   \   0000000E   0x2004             MOVS     R0,#+4
   \   00000010   0xE020             B.N      ??Get_Five_Dir_Value_1
     33              
     34              if(!LPLD_GPIO_Input_b(FIVE_DIR_U_PORT, FIVE_DIR_U_PIN))
   \                     ??Get_Five_Dir_Value_0: (+1)
   \   00000012   0x2101             MOVS     R1,#+1
   \   00000014   0x....             LDR.N    R0,??DataTable2  ;; 0x400ff0c0
   \   00000016   0x.... 0x....      BL       LPLD_GPIO_Input_b
   \   0000001A   0x2800             CMP      R0,#+0
   \   0000001C   0xD101             BNE.N    ??Get_Five_Dir_Value_2
     35                return FIVE_DIR_UP;
   \   0000001E   0x2001             MOVS     R0,#+1
   \   00000020   0xE018             B.N      ??Get_Five_Dir_Value_1
     36              
     37              if(!LPLD_GPIO_Input_b(FIVE_DIR_D_PORT, FIVE_DIR_D_PIN))
   \                     ??Get_Five_Dir_Value_2: (+1)
   \   00000022   0x2113             MOVS     R1,#+19
   \   00000024   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000026   0x.... 0x....      BL       LPLD_GPIO_Input_b
   \   0000002A   0x2800             CMP      R0,#+0
   \   0000002C   0xD101             BNE.N    ??Get_Five_Dir_Value_3
     38                return FIVE_DIR_DOWN;
   \   0000002E   0x2002             MOVS     R0,#+2
   \   00000030   0xE010             B.N      ??Get_Five_Dir_Value_1
     39          
     40              if(!LPLD_GPIO_Input_b(FIVE_DIR_L_PORT, FIVE_DIR_L_PIN))
   \                     ??Get_Five_Dir_Value_3: (+1)
   \   00000032   0x2112             MOVS     R1,#+18
   \   00000034   0x....             LDR.N    R0,??DataTable2_1  ;; 0x400ff080
   \   00000036   0x.... 0x....      BL       LPLD_GPIO_Input_b
   \   0000003A   0x2800             CMP      R0,#+0
   \   0000003C   0xD101             BNE.N    ??Get_Five_Dir_Value_4
     41                return FIVE_DIR_LEFT;
   \   0000003E   0x2003             MOVS     R0,#+3
   \   00000040   0xE008             B.N      ??Get_Five_Dir_Value_1
     42              
     43              if(!LPLD_GPIO_Input_b(FIVE_DIR_O_PORT, FIVE_DIR_O_PIN))
   \                     ??Get_Five_Dir_Value_4: (+1)
   \   00000042   0x2100             MOVS     R1,#+0
   \   00000044   0x....             LDR.N    R0,??DataTable2  ;; 0x400ff0c0
   \   00000046   0x.... 0x....      BL       LPLD_GPIO_Input_b
   \   0000004A   0x2800             CMP      R0,#+0
   \   0000004C   0xD101             BNE.N    ??Get_Five_Dir_Value_5
     44                return FIVE_DIR_OK;
   \   0000004E   0x2005             MOVS     R0,#+5
   \   00000050   0xE000             B.N      ??Get_Five_Dir_Value_1
     45                
     46              else 
     47                return FIVE_DIR_NULL;
   \                     ??Get_Five_Dir_Value_5: (+1)
   \   00000052   0x2000             MOVS     R0,#+0
   \                     ??Get_Five_Dir_Value_1: (+1)
   \   00000054   0xBD02             POP      {R1,PC}          ;; return
     48          }
     49          
     50          /*===============================================================
     51          	@brief     获取五向按键引脚状态
     52          	@note      消除按键抖动延时
     53          ==================================================================*/

   \                                 In section .text, align 2, keep-with-next
     54          uint8 Five_Dir_Button(uint8 *pu8FiveDirValue)
     55          {
   \                     Five_Dir_Button: (+1)
   \   00000000   0xB510             PUSH     {R4,LR}
   \   00000002   0xB082             SUB      SP,SP,#+8
   \   00000004   0x0004             MOVS     R4,R0
     56              uint8 u8ValueTemp = 0;
   \   00000006   0x2000             MOVS     R0,#+0
   \   00000008   0xF88D 0x0000      STRB     R0,[SP, #+0]
     57              static uint8 last_value;
     58              static int scan_delay = 50; //按键延时
     59              static uint8 change_flag=0;  
     60          
     61              *pu8FiveDirValue = 0;
   \   0000000C   0x2000             MOVS     R0,#+0
   \   0000000E   0x7020             STRB     R0,[R4, #+0]
     62              if(sleep_ms(scan_delay,0))
   \   00000010   0x2100             MOVS     R1,#+0
   \   00000012   0x....             LDR.N    R0,??DataTable2_2
   \   00000014   0x6800             LDR      R0,[R0, #+0]
   \   00000016   0x.... 0x....      BL       sleep_ms
   \   0000001A   0x2800             CMP      R0,#+0
   \   0000001C   0xD029             BEQ.N    ??Five_Dir_Button_0
     63              {
     64                  Get_Five_Dir_Value(&u8ValueTemp);
   \   0000001E   0x4668             MOV      R0,SP
   \   00000020   0x.... 0x....      BL       Get_Five_Dir_Value
     65                  if ((u8ValueTemp>=1) & (u8ValueTemp<=5)) //值能识别为正常按键
   \   00000024   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000028   0x2800             CMP      R0,#+0
   \   0000002A   0xD013             BEQ.N    ??Five_Dir_Button_1
   \   0000002C   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000030   0x2806             CMP      R0,#+6
   \   00000032   0xDA0F             BGE.N    ??Five_Dir_Button_1
     66                  {
     67                      
     68                      *pu8FiveDirValue = u8ValueTemp;
   \   00000034   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000038   0x7020             STRB     R0,[R4, #+0]
     69                      if(u8ValueTemp != last_value)
   \   0000003A   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   0000003E   0x....             LDR.N    R1,??DataTable2_3
   \   00000040   0x7809             LDRB     R1,[R1, #+0]
   \   00000042   0x4288             CMP      R0,R1
   \   00000044   0xD003             BEQ.N    ??Five_Dir_Button_2
     70                      {
     71                          change_flag = 1;
   \   00000046   0x2001             MOVS     R0,#+1
   \   00000048   0x....             LDR.N    R1,??DataTable2_4
   \   0000004A   0x7008             STRB     R0,[R1, #+0]
   \   0000004C   0xE002             B.N      ??Five_Dir_Button_1
     72                      }
     73                      else
     74                      {
     75                          change_flag = 0;
   \                     ??Five_Dir_Button_2: (+1)
   \   0000004E   0x2000             MOVS     R0,#+0
   \   00000050   0x....             LDR.N    R1,??DataTable2_4
   \   00000052   0x7008             STRB     R0,[R1, #+0]
     76                      }
     77                      
     78                  }
     79                  if(change_flag == 1)   //确认按下一次之后，等待较长时间再进行第二次检测
   \                     ??Five_Dir_Button_1: (+1)
   \   00000054   0x....             LDR.N    R0,??DataTable2_4
   \   00000056   0x7800             LDRB     R0,[R0, #+0]
   \   00000058   0x2801             CMP      R0,#+1
   \   0000005A   0xD103             BNE.N    ??Five_Dir_Button_3
     80                  {
     81                      scan_delay =200;
   \   0000005C   0x20C8             MOVS     R0,#+200
   \   0000005E   0x....             LDR.N    R1,??DataTable2_2
   \   00000060   0x6008             STR      R0,[R1, #+0]
   \   00000062   0xE002             B.N      ??Five_Dir_Button_4
     82                  }
     83                  else
     84                  {
     85                     scan_delay = 100;
   \                     ??Five_Dir_Button_3: (+1)
   \   00000064   0x2064             MOVS     R0,#+100
   \   00000066   0x....             LDR.N    R1,??DataTable2_2
   \   00000068   0x6008             STR      R0,[R1, #+0]
     86                  }
     87                  last_value = u8ValueTemp;
   \                     ??Five_Dir_Button_4: (+1)
   \   0000006A   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   0000006E   0x....             LDR.N    R1,??DataTable2_3
   \   00000070   0x7008             STRB     R0,[R1, #+0]
     88              }
     89              return u8ValueTemp;
   \                     ??Five_Dir_Button_0: (+1)
   \   00000072   0xF89D 0x0000      LDRB     R0,[SP, #+0]
   \   00000076   0xBD16             POP      {R1,R2,R4,PC}    ;; return
     90          }

   \                                 In section .bss, align 1
   \                     `Five_Dir_Button::last_value`:
   \   00000000                      DS8 1

   \                                 In section .data, align 4
   \                     `Five_Dir_Button::scan_delay`:
   \   00000000   0x00000032         DC32 50

   \                                 In section .bss, align 1
   \                     `Five_Dir_Button::change_flag`:
   \   00000000                      DS8 1

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2:
   \   00000000   0x400FF0C0         DC32     0x400ff0c0

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_1:
   \   00000000   0x400FF080         DC32     0x400ff080

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_2:
   \   00000000   0x........         DC32     `Five_Dir_Button::scan_delay`

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_3:
   \   00000000   0x........         DC32     `Five_Dir_Button::last_value`

   \                                 In section .text, align 4, keep-with-next
   \                     ??DataTable2_4:
   \   00000000   0x........         DC32     `Five_Dir_Button::change_flag`

   Maximum stack usage in bytes:

   .cstack Function
   ------- --------
      16   Five_Dir_Button
        16   -> Get_Five_Dir_Value
        16   -> sleep_ms
       8   Five_Dir_Init
         8   -> GPIO_Init
       8   Get_Five_Dir_Value
         8   -> LPLD_GPIO_Input_b


   Section sizes:

   Bytes  Function/Label
   -----  --------------
       4  ??DataTable2
       4  ??DataTable2_1
       4  ??DataTable2_2
       4  ??DataTable2_3
       4  ??DataTable2_4
     120  Five_Dir_Button
      70  Five_Dir_Init
      86  Get_Five_Dir_Value
       1  change_flag
       1  last_value
       4  scan_delay

 
   2 bytes in section .bss
   4 bytes in section .data
 296 bytes in section .text
 
 296 bytes of CODE memory
   6 bytes of DATA memory

Errors: none
Warnings: none
